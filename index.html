<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Painel Executivo de Projetos Estrat√©gicos</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>
<body>
    <!-- Tela de Login -->
    <div id="login-screen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <div class="login-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h1 id="login-title">Painel Executivo</h1>
                <p id="login-subtitle">Projetos Estrat√©gicos</p>
            </div>
            <form id="login-form" class="login-form">
                <div class="form-group">
                    <label for="email">E-mail</label>
                    <input type="email" id="email" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha</label>
                    <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <button type="submit" class="btn-login">
                    <span>Entrar</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
                <div id="login-error" class="login-error"></div>
            </form>
            <div class="login-footer">
                <button id="forgot-password-btn" class="btn-link">Esqueci a senha</button>
            </div>
        </div>
    </div>

    <!-- Modal de Recupera√ß√£o de Senha -->
    <div id="forgot-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Recuperar Senha</h2>
                <button class="modal-close" data-modal="forgot-modal"><i class="fas fa-times"></i></button>
            </div>
            <form id="forgot-form">
                <div class="form-group">
                    <label for="forgot-email">E-mail</label>
                    <input type="email" id="forgot-email" placeholder="seu@email.com" required>
                </div>
                <button type="submit" class="btn-primary">Enviar Link de Recupera√ß√£o</button>
                <div id="forgot-message" class="login-error"></div>
            </form>
        </div>
    </div>

    <!-- Painel Principal -->
    <div id="app-container" class="container hidden">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2 id="sidebar-title">Painel Executivo</h2>
                <p id="sidebar-subtitle">Projetos Estrat√©gicos</p>
            </div>
            
            <div class="user-info">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-details">
                    <span id="user-email"></span>
                    <div class="user-actions">
                        <button id="settings-btn" class="btn-settings" title="Configura√ß√µes">
                            <i class="fas fa-cog"></i>
                        </button>
                        <button id="logout-btn" class="btn-logout" title="Sair">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="summary-cards">
                <div class="card">
                    <div class="card-icon"><i class="fas fa-tasks"></i></div>
                    <div class="card-content">
                        <h3 id="total-projects">0</h3>
                        <p>Projetos Totais</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-icon ongoing"><i class="fas fa-cogs"></i></div>
                    <div class="card-content">
                        <h3 id="ongoing-projects">0</h3>
                        <p>Em Andamento</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-icon completed"><i class="fas fa-check-circle"></i></div>
                    <div class="card-content">
                        <h3 id="completed-projects">0</h3>
                        <p>Conclu√≠dos</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-icon planned"><i class="fas fa-flag"></i></div>
                    <div class="card-content">
                        <h3 id="planned-projects">0</h3>
                        <p>Planejados</p>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <h3>Status dos Projetos</h3>
                <canvas id="status-chart"></canvas>
            </div>

            <div class="kpi-container">
                <h3>Indicadores Chave (KPIs)</h3>
                <div class="kpi">
                    <p>Progresso M√©dio</p>
                    <div class="progress-bar-background">
                        <div class="progress-bar-foreground" id="avg-progress-bar"></div>
                    </div>
                    <span id="avg-progress-text">0%</span>
                </div>
                <div class="kpi">
                    <p>Prazos Vencidos</p>
                    <span id="overdue-deadlines" class="kpi-value danger">0</span>
                </div>
                <div class="kpi">
                    <p>Pr√≥ximos Prazos (7 dias)</p>
                    <span id="upcoming-deadlines" class="kpi-value warning">0</span>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <header class="main-header">
                <h1 id="main-title">Vis√£o Geral dos Projetos</h1>
                <div class="header-actions">
                    <div class="filters">
                        <label for="status-filter">Filtrar:</label>
                        <select id="status-filter">
                            <option value="todos">Todos</option>
                            <option value="Em andamento">Em Andamento</option>
                            <option value="Planejado">Planejado</option>
                            <option value="Conclu√≠do">Conclu√≠do</option>
                            <option value="N√£o iniciado">N√£o Iniciado</option>
                            <option value="Suspenso">Suspenso</option>
                        </select>
                    </div>
                    
                    <div class="action-buttons">
                        <button id="add-project-btn" class="btn-action btn-add">
                            <i class="fas fa-plus"></i> Novo Projeto
                        </button>

                        <button id="open-tasks-btn" class="btn-action btn-tasks">
                            <i class="fas fa-list-check"></i> Pr√≥ximos Passos
                            <span id="tasks-count" class="badge">0</span>
                        </button>

                        <button id="open-reminders-btn" class="btn-action btn-reminders">
                            <i class="fas fa-bell"></i> Lembretes
                            <span id="reminders-count" class="badge">0</span>
                        </button>
                        
                        <div class="dropdown">
                            <button class="btn-action btn-export dropdown-toggle">
                                <i class="fas fa-download"></i> Exportar
                            </button>
                            <div class="dropdown-menu">
                                <button id="export-xlsx" class="dropdown-item">
                                    <i class="fas fa-file-excel"></i> Excel (.xlsx)
                                </button>
                                <button id="export-csv" class="dropdown-item">
                                    <i class="fas fa-file-csv"></i> CSV
                                </button>
                                <button id="export-pdf" class="dropdown-item">
                                    <i class="fas fa-file-pdf"></i> PDF Simples
                                </button>
                                <button id="export-report" class="dropdown-item">
                                    <i class="fas fa-file-alt"></i> Relat√≥rio Executivo
                                </button>
                            </div>
                        </div>

                        <div class="dropdown">
                            <button class="btn-action btn-import dropdown-toggle">
                                <i class="fas fa-upload"></i> Importar
                            </button>
                            <div class="dropdown-menu">
                                <button id="import-xlsx" class="dropdown-item">
                                    <i class="fas fa-file-excel"></i> Excel (.xlsx)
                                </button>
                                <button id="import-csv" class="dropdown-item">
                                    <i class="fas fa-file-csv"></i> CSV
                                </button>
                            </div>
                        </div>

                        <div class="dropdown">
                            <button class="btn-action btn-manage dropdown-toggle">
                                <i class="fas fa-cogs"></i> Gerenciar
                            </button>
                            <div class="dropdown-menu">
                                <button id="clear-all-tasks" class="dropdown-item">
                                    <i class="fas fa-broom"></i> Limpar Todas as Tarefas
                                </button>
                                <button id="clear-all-projects" class="dropdown-item dropdown-item-danger">
                                    <i class="fas fa-trash-alt"></i> Apagar Todos os Projetos
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <div class="table-container">
                <table id="projects-table">
                    <thead>
                        <tr>
                            <th>N¬∫</th>
                            <th>Nome do Projeto</th>
                            <th>Pr√≥ximos Passos</th>
                            <th>Status</th>
                            <th>Progresso</th>
                            <th>Prazo</th>
                            <th>Anexos</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="projects-table-body">
                    </tbody>
                </table>
            </div>

            <div class="comments-section">
                <h2>Mural de Coment√°rios e Anota√ß√µes</h2>
                <textarea id="comment-input" placeholder="Digite um novo coment√°rio ou anota√ß√£o..."></textarea>
                <button id="add-comment-btn" class="btn-action">
                    <i class="fas fa-comment"></i> Adicionar Coment√°rio
                </button>
                <div id="comments-list"></div>
            </div>
        </main>
    </div>

    <!-- Modal de Projeto (Adicionar/Editar) -->
    <div id="project-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="modal-title">Novo Projeto</h2>
                <button class="modal-close" data-modal="project-modal"><i class="fas fa-times"></i></button>
            </div>
            <form id="project-form">
                <input type="hidden" id="project-id">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="project-name">Nome do Projeto *</label>
                        <input type="text" id="project-name" required>
                    </div>
                    <div class="form-group">
                        <label for="project-status">Status *</label>
                        <select id="project-status" required>
                            <option value="N√£o iniciado">N√£o Iniciado</option>
                            <option value="Planejado">Planejado</option>
                            <option value="Em andamento">Em Andamento</option>
                            <option value="Conclu√≠do">Conclu√≠do</option>
                            <option value="Suspenso">Suspenso</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="project-progress">Progresso (%) *</label>
                        <input type="number" id="project-progress" min="0" max="100" value="0" required>
                    </div>
                    <div class="form-group">
                        <label for="project-deadline">Prazo</label>
                        <input type="date" id="project-deadline">
                    </div>
                </div>

                <div class="form-group">
                    <label for="project-description">Descri√ß√£o</label>
                    <textarea id="project-description" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label for="project-objective">Objetivo</label>
                    <textarea id="project-objective" rows="2"></textarea>
                </div>

                <div class="form-group">
                    <label for="project-responsible">Respons√°vel</label>
                    <input type="text" id="project-responsible">
                </div>

                <div class="form-group">
                    <label>Pr√≥ximos Passos</label>
                    <div id="next-steps-container">
                        <div class="next-step-item">
                            <div class="step-main">
                                <input type="text" class="next-step-input" placeholder="Descreva o pr√≥ximo passo">
                            </div>
                            <div class="step-details">
                                <select class="step-status">
                                    <option value="pendente">‚è≥ Pendente</option>
                                    <option value="em_andamento">üîÑ Em Andamento</option>
                                    <option value="concluido">‚úÖ Conclu√≠do</option>
                                </select>
                                <input type="date" class="step-prazo" title="Prazo">
                                <input type="text" class="step-responsavel" placeholder="Respons√°vel">
                            </div>
                            <button type="button" class="btn-remove-step"><i class="fas fa-times"></i></button>
                        </div>
                    </div>
                    <button type="button" id="add-step-btn" class="btn-add-step">
                        <i class="fas fa-plus"></i> Adicionar Passo
                    </button>
                </div>

                <div class="form-section">
                    <h3>An√°lise SWOT</h3>
                    <div class="swot-grid">
                        <div class="form-group">
                            <label for="swot-strengths">For√ßas</label>
                            <textarea id="swot-strengths" rows="2" placeholder="Pontos fortes do projeto"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="swot-weaknesses">Fraquezas</label>
                            <textarea id="swot-weaknesses" rows="2" placeholder="Pontos fracos do projeto"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="swot-opportunities">Oportunidades</label>
                            <textarea id="swot-opportunities" rows="2" placeholder="Oportunidades identificadas"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="swot-threats">Amea√ßas</label>
                            <textarea id="swot-threats" rows="2" placeholder="Amea√ßas identificadas"></textarea>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Metas</label>
                    <div id="goals-container">
                        <div class="goal-item">
                            <input type="text" class="goal-input" placeholder="Descreva uma meta">
                            <button type="button" class="btn-remove-goal"><i class="fas fa-times"></i></button>
                        </div>
                    </div>
                    <button type="button" id="add-goal-btn" class="btn-add-step">
                        <i class="fas fa-plus"></i> Adicionar Meta
                    </button>
                </div>

                <div class="form-section">
                    <h3><i class="fas fa-paperclip"></i> Arquivos Anexos</h3>
                    <div class="file-upload-area" id="file-upload-area">
                        <input type="file" id="project-files" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif">
                        <div class="upload-placeholder">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Arraste arquivos aqui ou clique para selecionar</p>
                            <span>PDF, Word, Excel, Imagens (m√°x. 10MB cada)</span>
                        </div>
                    </div>
                    <div id="files-preview" class="files-preview"></div>
                    <div id="existing-files" class="existing-files"></div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-cancel" data-modal="project-modal">Cancelar</button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Salvar Projeto
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Detalhes do Projeto -->
    <div id="project-details-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="details-title">Detalhes do Projeto</h2>
                <button class="modal-close" data-modal="project-details-modal"><i class="fas fa-times"></i></button>
            </div>
            <div id="project-details-content">
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o de Exclus√£o -->
    <div id="delete-modal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Confirmar Exclus√£o</h2>
                <button class="modal-close" data-modal="delete-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <p>Tem certeza que deseja excluir o projeto <strong id="delete-project-name"></strong>?</p>
                <p class="warning-text">Esta a√ß√£o n√£o pode ser desfeita.</p>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel" data-modal="delete-modal">Cancelar</button>
                <button id="confirm-delete-btn" class="btn-danger">
                    <i class="fas fa-trash"></i> Excluir
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o - Apagar TODOS os Projetos -->
    <div id="delete-all-modal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header modal-header-danger">
                <h2><i class="fas fa-exclamation-triangle"></i> Aten√ß√£o!</h2>
                <button class="modal-close" data-modal="delete-all-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <p class="danger-text">Voc√™ est√° prestes a <strong>APAGAR TODOS OS PROJETOS</strong>!</p>
                <p>Esta a√ß√£o ir√° remover permanentemente:</p>
                <ul class="delete-list">
                    <li><i class="fas fa-folder"></i> <span id="delete-all-count">0</span> projeto(s)</li>
                    <li><i class="fas fa-tasks"></i> Todas as tarefas/pr√≥ximos passos</li>
                    <li><i class="fas fa-paperclip"></i> Todos os arquivos anexos</li>
                    <li><i class="fas fa-comment"></i> Todos os coment√°rios</li>
                </ul>
                <p class="warning-text"><i class="fas fa-ban"></i> Esta a√ß√£o N√ÉO pode ser desfeita!</p>
                <div class="confirm-input-group">
                    <label>Digite <strong>CONFIRMAR</strong> para prosseguir:</label>
                    <input type="text" id="confirm-delete-all-input" placeholder="CONFIRMAR" autocomplete="off">
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel" data-modal="delete-all-modal">Cancelar</button>
                <button id="confirm-delete-all-btn" class="btn-danger" disabled>
                    <i class="fas fa-trash-alt"></i> Apagar Tudo
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o - Limpar TODAS as Tarefas -->
    <div id="clear-tasks-modal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header modal-header-warning">
                <h2><i class="fas fa-broom"></i> Limpar Tarefas</h2>
                <button class="modal-close" data-modal="clear-tasks-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <p>Escolha uma op√ß√£o:</p>
                <div class="clear-options">
                    <label class="radio-option">
                        <input type="radio" name="clear-tasks-option" value="all" checked>
                        <span>Limpar tarefas de <strong>todos os projetos</strong></span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="clear-tasks-option" value="specific">
                        <span>Limpar tarefas de um projeto espec√≠fico</span>
                    </label>
                </div>
                <div id="specific-project-select" class="form-group" style="display: none; margin-top: 1rem;">
                    <label for="clear-tasks-project">Selecione o projeto:</label>
                    <select id="clear-tasks-project">
                        <!-- Preenchido via JS -->
                    </select>
                </div>
                <p class="warning-text" style="margin-top: 1rem;">Os projetos ser√£o mantidos, apenas as tarefas/pr√≥ximos passos ser√£o removidos.</p>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel" data-modal="clear-tasks-modal">Cancelar</button>
                <button id="confirm-clear-tasks-btn" class="btn-warning">
                    <i class="fas fa-broom"></i> Limpar Tarefas
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Configura√ß√µes -->
    <div id="settings-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-cog"></i> Configura√ß√µes do Painel</h2>
                <button class="modal-close" data-modal="settings-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="settings-tabs">
                <button class="tab-btn active" data-tab="appearance">
                    <i class="fas fa-palette"></i> Apar√™ncia
                </button>
                <button class="tab-btn" data-tab="texts">
                    <i class="fas fa-font"></i> Textos
                </button>
                <button class="tab-btn" data-tab="notifications">
                    <i class="fas fa-bell"></i> Notifica√ß√µes
                </button>
            </div>
            <form id="settings-form">
                <!-- Aba Apar√™ncia -->
                <div class="tab-content active" id="tab-appearance">
                    <h3>Cores do Tema</h3>
                    <div class="color-grid">
                        <div class="form-group">
                            <label for="color-primary">Cor Principal</label>
                            <div class="color-input-wrapper">
                                <input type="color" id="color-primary" value="#58a6ff">
                                <input type="text" id="color-primary-hex" value="#58a6ff" maxlength="7">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="color-sidebar">Cor da Barra Lateral</label>
                            <div class="color-input-wrapper">
                                <input type="color" id="color-sidebar" value="#161b22">
                                <input type="text" id="color-sidebar-hex" value="#161b22" maxlength="7">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="color-background">Cor de Fundo</label>
                            <div class="color-input-wrapper">
                                <input type="color" id="color-background" value="#0d1117">
                                <input type="text" id="color-background-hex" value="#0d1117" maxlength="7">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="color-cards">Cor dos Cards</label>
                            <div class="color-input-wrapper">
                                <input type="color" id="color-cards" value="#161b22">
                                <input type="text" id="color-cards-hex" value="#161b22" maxlength="7">
                            </div>
                        </div>
                    </div>
                    
                    <h3>Cores de Status</h3>
                    <div class="color-grid">
                        <div class="form-group">
                            <label for="color-status-andamento">Em Andamento</label>
                            <div class="color-input-wrapper">
                                <input type="color" id="color-status-andamento" value="#58a6ff">
                                <input type="text" id="color-status-andamento-hex" value="#58a6ff" maxlength="7">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="color-status-concluido">Conclu√≠do</label>
                            <div class="color-input-wrapper">
                                <input type="color" id="color-status-concluido" value="#3fb950">
                                <input type="text" id="color-status-concluido-hex" value="#3fb950" maxlength="7">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="color-status-planejado">Planejado</label>
                            <div class="color-input-wrapper">
                                <input type="color" id="color-status-planejado" value="#d29922">
                                <input type="text" id="color-status-planejado-hex" value="#d29922" maxlength="7">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="color-status-suspenso">Suspenso</label>
                            <div class="color-input-wrapper">
                                <input type="color" id="color-status-suspenso" value="#f85149">
                                <input type="text" id="color-status-suspenso-hex" value="#f85149" maxlength="7">
                            </div>
                        </div>
                    </div>

                    <div class="preset-themes">
                        <h3>Temas Predefinidos</h3>
                        <div class="theme-buttons">
                            <button type="button" class="theme-btn" data-theme="dark">
                                <span class="theme-preview dark"></span> Escuro (Padr√£o)
                            </button>
                            <button type="button" class="theme-btn" data-theme="light">
                                <span class="theme-preview light"></span> Claro
                            </button>
                            <button type="button" class="theme-btn" data-theme="blue">
                                <span class="theme-preview blue"></span> Azul Corporativo
                            </button>
                            <button type="button" class="theme-btn" data-theme="green">
                                <span class="theme-preview green"></span> Verde Natural
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Aba Textos -->
                <div class="tab-content" id="tab-texts">
                    <h3>T√≠tulos do Painel</h3>
                    <div class="form-group">
                        <label for="text-main-title">T√≠tulo Principal</label>
                        <input type="text" id="text-main-title" value="Painel Executivo" placeholder="Ex: Painel Executivo">
                    </div>
                    <div class="form-group">
                        <label for="text-subtitle">Subt√≠tulo</label>
                        <input type="text" id="text-subtitle" value="Projetos Estrat√©gicos" placeholder="Ex: Projetos Estrat√©gicos">
                    </div>
                    <div class="form-group">
                        <label for="text-page-title">T√≠tulo da P√°gina</label>
                        <input type="text" id="text-page-title" value="Vis√£o Geral dos Projetos" placeholder="Ex: Vis√£o Geral dos Projetos">
                    </div>

                    <h3>Labels dos Cards</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="text-card-total">Card Total</label>
                            <input type="text" id="text-card-total" value="Projetos Totais">
                        </div>
                        <div class="form-group">
                            <label for="text-card-ongoing">Card Em Andamento</label>
                            <input type="text" id="text-card-ongoing" value="Em Andamento">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="text-card-completed">Card Conclu√≠dos</label>
                            <input type="text" id="text-card-completed" value="Conclu√≠dos">
                        </div>
                        <div class="form-group">
                            <label for="text-card-planned">Card Planejados</label>
                            <input type="text" id="text-card-planned" value="Planejados">
                        </div>
                    </div>

                    <h3>Informa√ß√µes do Relat√≥rio</h3>
                    <div class="form-group">
                        <label for="text-org-name">Nome da Organiza√ß√£o</label>
                        <input type="text" id="text-org-name" value="" placeholder="Ex: Comiss√£o de Assuntos Sociais - CAS">
                    </div>
                    <div class="form-group">
                        <label for="text-report-header">Cabe√ßalho do Relat√≥rio</label>
                        <input type="text" id="text-report-header" value="" placeholder="Ex: C√¢mara Legislativa do Distrito Federal">
                    </div>
                </div>

                <!-- Aba Notifica√ß√µes -->
                <div class="tab-content" id="tab-notifications">
                    <h3>Configura√ß√£o de E-mail</h3>
                    <p class="settings-description">Configure o servi√ßo de e-mail para receber notifica√ß√µes de prazos e lembretes.</p>
                    
                    <div class="form-group">
                        <label for="notification-email">E-mail para Notifica√ß√µes</label>
                        <input type="email" id="notification-email" placeholder="seu@email.com">
                    </div>

                    <div class="notification-options">
                        <h4>Quando notificar:</h4>
                        <label class="checkbox-label">
                            <input type="checkbox" id="notify-deadline-7" checked>
                            <span>7 dias antes do prazo</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="notify-deadline-3" checked>
                            <span>3 dias antes do prazo</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="notify-deadline-1" checked>
                            <span>1 dia antes do prazo</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="notify-deadline-day">
                            <span>No dia do prazo</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="notify-overdue" checked>
                            <span>Quando o prazo vencer</span>
                        </label>
                    </div>

                    <div class="emailjs-config">
                        <h4>Configura√ß√£o EmailJS (opcional)</h4>
                        <p class="settings-description">Para envio de e-mails, configure sua conta <a href="https://www.emailjs.com/" target="_blank">EmailJS</a> gratuita.</p>
                        <div class="form-group">
                            <label for="emailjs-public-key">Public Key</label>
                            <input type="text" id="emailjs-public-key" placeholder="Sua Public Key do EmailJS">
                        </div>
                        <div class="form-group">
                            <label for="emailjs-service-id">Service ID</label>
                            <input type="text" id="emailjs-service-id" placeholder="Seu Service ID">
                        </div>
                        <div class="form-group">
                            <label for="emailjs-template-id">Template ID</label>
                            <input type="text" id="emailjs-template-id" placeholder="Seu Template ID">
                        </div>
                        <button type="button" id="test-email-btn" class="btn-action">
                            <i class="fas fa-paper-plane"></i> Testar Envio
                        </button>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" id="reset-settings-btn" class="btn-cancel">
                        <i class="fas fa-undo"></i> Restaurar Padr√µes
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Salvar Configura√ß√µes
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Lembretes -->
    <div id="reminders-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-bell"></i> Lembretes</h2>
                <button class="modal-close" data-modal="reminders-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="reminders-header">
                <button id="add-reminder-btn" class="btn-action btn-add">
                    <i class="fas fa-plus"></i> Novo Lembrete
                </button>
            </div>
            <div id="reminders-list" class="reminders-list">
                <!-- Lembretes ser√£o inseridos aqui -->
            </div>
        </div>
    </div>

    <!-- Modal de Criar/Editar Lembrete -->
    <div id="reminder-form-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="reminder-modal-title">Novo Lembrete</h2>
                <button class="modal-close" data-modal="reminder-form-modal"><i class="fas fa-times"></i></button>
            </div>
            <form id="reminder-form">
                <input type="hidden" id="reminder-id">
                
                <div class="form-group">
                    <label for="reminder-title">T√≠tulo *</label>
                    <input type="text" id="reminder-title" required placeholder="Ex: Reuni√£o semanal">
                </div>

                <div class="form-group">
                    <label for="reminder-description">Descri√ß√£o</label>
                    <textarea id="reminder-description" rows="2" placeholder="Detalhes do lembrete..."></textarea>
                </div>

                <div class="form-group">
                    <label for="reminder-project">Projeto Vinculado</label>
                    <select id="reminder-project">
                        <option value="">Nenhum (lembrete geral)</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="reminder-date">Data *</label>
                        <input type="date" id="reminder-date" required>
                    </div>
                    <div class="form-group">
                        <label for="reminder-time">Hor√°rio</label>
                        <input type="time" id="reminder-time" value="09:00">
                    </div>
                </div>

                <div class="form-group">
                    <label for="reminder-recurrence">Recorr√™ncia</label>
                    <select id="reminder-recurrence">
                        <option value="none">N√£o repetir</option>
                        <option value="daily">Diariamente</option>
                        <option value="weekly">Semanalmente</option>
                        <option value="biweekly">Quinzenalmente</option>
                        <option value="monthly">Mensalmente</option>
                    </select>
                </div>

                <div id="recurrence-options" class="recurrence-options hidden">
                    <div class="form-group">
                        <label for="reminder-end-date">Repetir at√©</label>
                        <input type="date" id="reminder-end-date">
                    </div>
                </div>

                <label class="checkbox-label">
                    <input type="checkbox" id="reminder-notify" checked>
                    <span>Enviar notifica√ß√£o por e-mail</span>
                </label>

                <label class="checkbox-label">
                    <input type="checkbox" id="reminder-calendar">
                    <span>Adicionar ao Google Calendar</span>
                </label>

                <div class="modal-actions">
                    <button type="button" class="btn-cancel" data-modal="reminder-form-modal">Cancelar</button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Salvar Lembrete
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Gera√ß√£o de Relat√≥rio -->
    <div id="report-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-file-alt"></i> Gerar Relat√≥rio Executivo</h2>
                <button class="modal-close" data-modal="report-modal"><i class="fas fa-times"></i></button>
            </div>
            <form id="report-form">
                <div class="form-group">
                    <label for="report-title">T√≠tulo do Relat√≥rio</label>
                    <input type="text" id="report-title" value="Relat√≥rio Executivo de Projetos">
                </div>

                <div class="form-group">
                    <label for="report-period">Per√≠odo</label>
                    <input type="text" id="report-period" placeholder="Ex: Janeiro a Mar√ßo de 2025">
                </div>

                <div class="form-group">
                    <label for="report-author">Elaborado por</label>
                    <input type="text" id="report-author" placeholder="Seu nome">
                </div>

                <div class="form-group">
                    <label>Incluir no relat√≥rio:</label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="report-summary" checked>
                        <span>Resumo executivo</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="report-chart" checked>
                        <span>Gr√°fico de status</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="report-details" checked>
                        <span>Detalhes dos projetos</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="report-swot">
                        <span>An√°lise SWOT</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="report-next-steps" checked>
                        <span>Pr√≥ximos passos</span>
                    </label>
                </div>

                <div class="form-group">
                    <label for="report-filter">Filtrar projetos</label>
                    <select id="report-filter">
                        <option value="todos">Todos os projetos</option>
                        <option value="Em andamento">Apenas Em Andamento</option>
                        <option value="Planejado">Apenas Planejados</option>
                        <option value="Conclu√≠do">Apenas Conclu√≠dos</option>
                    </select>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-cancel" data-modal="report-modal">Cancelar</button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-file-pdf"></i> Gerar PDF
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Exporta√ß√£o Personalizada -->
    <div id="export-modal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2><i class="fas fa-file-export"></i> Exportar Dados</h2>
                <button class="modal-close" data-modal="export-modal"><i class="fas fa-times"></i></button>
            </div>
            <form id="export-form">
                <div class="export-format-tabs">
                    <button type="button" class="export-tab active" data-format="xlsx">
                        <i class="fas fa-file-excel"></i> Excel (XLSX)
                    </button>
                    <button type="button" class="export-tab" data-format="pdf">
                        <i class="fas fa-file-pdf"></i> PDF
                    </button>
                    <button type="button" class="export-tab" data-format="csv">
                        <i class="fas fa-file-csv"></i> CSV
                    </button>
                </div>

                <div class="export-sections">
                    <div class="export-section">
                        <h4><i class="fas fa-filter"></i> Filtrar Projetos</h4>
                        <select id="export-project-filter">
                            <option value="todos">Todos os projetos</option>
                            <option value="Em andamento">Apenas Em Andamento</option>
                            <option value="Planejado">Apenas Planejados</option>
                            <option value="Conclu√≠do">Apenas Conclu√≠dos</option>
                            <option value="Suspenso">Apenas Suspensos</option>
                        </select>
                    </div>

                    <div class="export-section">
                        <h4><i class="fas fa-columns"></i> Campos a Exportar</h4>
                        <p class="export-hint">Selecione os campos que deseja incluir na exporta√ß√£o:</p>
                        
                        <div class="export-fields-grid">
                            <div class="export-field-group">
                                <h5>Informa√ß√µes B√°sicas</h5>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-id" checked>
                                    <span>ID</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-nome" checked>
                                    <span>Nome do Projeto</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-status" checked>
                                    <span>Status</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-progresso" checked>
                                    <span>Progresso (%)</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-prazo" checked>
                                    <span>Prazo</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-responsavel" checked>
                                    <span>Respons√°vel</span>
                                </label>
                            </div>

                            <div class="export-field-group">
                                <h5>Detalhes</h5>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-descricao">
                                    <span>Descri√ß√£o</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-objetivo">
                                    <span>Objetivo</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-proximos" checked>
                                    <span>Pr√≥ximos Passos</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-metas">
                                    <span>Metas</span>
                                </label>
                            </div>

                            <div class="export-field-group">
                                <h5>An√°lise SWOT</h5>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-forcas">
                                    <span>For√ßas</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-fraquezas">
                                    <span>Fraquezas</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-oportunidades">
                                    <span>Oportunidades</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="export-field-ameacas">
                                    <span>Amea√ßas</span>
                                </label>
                            </div>
                        </div>

                        <div class="export-quick-actions">
                            <button type="button" id="export-select-all" class="btn-link">
                                <i class="fas fa-check-double"></i> Selecionar Todos
                            </button>
                            <button type="button" id="export-select-none" class="btn-link">
                                <i class="fas fa-times"></i> Desmarcar Todos
                            </button>
                        </div>
                    </div>

                    <div class="export-section export-options-pdf" style="display: none;">
                        <h4><i class="fas fa-cog"></i> Op√ß√µes do PDF</h4>
                        <div class="form-group">
                            <label for="export-pdf-title">T√≠tulo do Documento</label>
                            <input type="text" id="export-pdf-title" value="Relat√≥rio de Projetos">
                        </div>
                        <div class="form-group">
                            <label for="export-pdf-orientation">Orienta√ß√£o</label>
                            <select id="export-pdf-orientation">
                                <option value="landscape">Paisagem (melhor para tabelas)</option>
                                <option value="portrait">Retrato</option>
                            </select>
                        </div>
                        <label class="checkbox-label">
                            <input type="checkbox" id="export-pdf-header" checked>
                            <span>Incluir cabe√ßalho com data</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="export-pdf-footer" checked>
                            <span>Incluir rodap√© com numera√ß√£o</span>
                        </label>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-cancel" data-modal="export-modal">Cancelar</button>
                    <button type="submit" class="btn-primary" id="export-submit-btn">
                        <i class="fas fa-download"></i> Exportar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Input oculto para importa√ß√£o -->
    <input type="file" id="file-input" accept=".xlsx,.xls,.csv" style="display: none;">

    <!-- Painel Lateral de Pr√≥ximos Passos -->
    <div id="tasks-panel" class="tasks-panel">
        <div class="tasks-panel-header">
            <div class="tasks-header-title">
                <i class="fas fa-list-check"></i>
                <h2>Pr√≥ximos Passos</h2>
            </div>
            <button id="close-tasks-panel" class="btn-close-panel">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="tasks-panel-filters">
            <div class="tasks-filter-group">
                <label>Filtrar por projeto:</label>
                <select id="tasks-project-filter">
                    <option value="todos">Todos os projetos</option>
                </select>
            </div>
            <div class="tasks-filter-group">
                <label>Filtrar por status:</label>
                <select id="tasks-status-filter">
                    <option value="todos">Todos</option>
                    <option value="pendente">‚è≥ Pendentes</option>
                    <option value="em_andamento">üîÑ Em Andamento</option>
                    <option value="agendado">üìÖ Agendados</option>
                    <option value="concluido">‚úÖ Conclu√≠dos</option>
                </select>
            </div>
        </div>

        <div class="tasks-panel-stats">
            <div class="task-stat">
                <span class="stat-number" id="stat-total-tasks">0</span>
                <span class="stat-label">Total</span>
            </div>
            <div class="task-stat">
                <span class="stat-number pending" id="stat-pending-tasks">0</span>
                <span class="stat-label">Pendentes</span>
            </div>
            <div class="task-stat">
                <span class="stat-number in-progress" id="stat-in-progress-tasks">0</span>
                <span class="stat-label">Em Andamento</span>
            </div>
            <div class="task-stat">
                <span class="stat-number completed" id="stat-completed-tasks">0</span>
                <span class="stat-label">Conclu√≠dos</span>
            </div>
        </div>

        <div class="tasks-panel-content" id="tasks-list">
        </div>

        <div class="tasks-panel-footer">
            <button id="export-tasks-calendar" class="btn-action btn-calendar-export">
                <i class="fab fa-google"></i> Exportar para Google Calendar
            </button>
        </div>
    </div>

    <!-- Overlay do painel -->
    <div id="tasks-panel-overlay" class="tasks-panel-overlay"></div>

    <!-- Modal de Agendamento -->
    <div id="schedule-modal" class="modal">
        <div class="modal-content modal-schedule">
            <div class="modal-header">
                <h2><i class="fas fa-calendar-plus"></i> Agendar no Google Calendar</h2>
                <button class="modal-close" data-modal="schedule-modal"><i class="fas fa-times"></i></button>
            </div>
            <form id="schedule-form">
                <input type="hidden" id="schedule-task-id">
                <input type="hidden" id="schedule-project-id">
                
                <div class="schedule-task-preview">
                    <div class="preview-project">
                        <i class="fas fa-folder"></i>
                        <span id="schedule-project-name"></span>
                    </div>
                    <div class="preview-task">
                        <i class="fas fa-tasks"></i>
                        <span id="schedule-task-text"></span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="schedule-title">T√≠tulo do Evento</label>
                    <input type="text" id="schedule-title" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="schedule-date">Data</label>
                        <input type="date" id="schedule-date" required>
                    </div>
                    <div class="form-group">
                        <label for="schedule-time">Hor√°rio</label>
                        <input type="time" id="schedule-time" value="09:00">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="schedule-duration">Dura√ß√£o</label>
                        <select id="schedule-duration">
                            <option value="30">30 minutos</option>
                            <option value="60" selected>1 hora</option>
                            <option value="90">1h 30min</option>
                            <option value="120">2 horas</option>
                            <option value="180">3 horas</option>
                            <option value="240">4 horas</option>
                            <option value="480">8 horas (dia inteiro)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="schedule-reminder">Lembrete</label>
                        <select id="schedule-reminder">
                            <option value="10">10 minutos antes</option>
                            <option value="30" selected>30 minutos antes</option>
                            <option value="60">1 hora antes</option>
                            <option value="1440">1 dia antes</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="schedule-description">Descri√ß√£o (opcional)</label>
                    <textarea id="schedule-description" rows="3" placeholder="Detalhes adicionais sobre a tarefa..."></textarea>
                </div>

                <div class="form-group">
                    <label for="schedule-location">Local (opcional)</label>
                    <input type="text" id="schedule-location" placeholder="Ex: Sala de reuni√µes, Online, etc.">
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-cancel" data-modal="schedule-modal">Cancelar</button>
                    <button type="submit" class="btn-primary btn-google">
                        <i class="fab fa-google"></i> Abrir no Google Calendar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast de Notifica√ß√£o -->
    <div id="toast" class="toast">
        <i class="toast-icon"></i>
        <span class="toast-message"></span>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="spinner"></div>
        <p>Carregando...</p>
    </div>

    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="utils.js"></script>
    <script src="export.js"></script>
    <script src="import.js"></script>
    <script src="settings.js"></script>
    <script src="reminders.js"></script>
    <script src="files.js"></script>
    <script src="reports.js"></script>
    <script src="app.js"></script>
</body>
</html>
